/*! blabr 2015-08-24 */
(function(){var App,Background,BlabEvents,Buttons,Computation,ComputationButtons,ComputationEditor,Definitions,EditPageButton,Errors,GoogleAnalytics,Layout,Loader,MarkdownEditor,PopupEditorManager,Settings,TextEditor,Widget,WidgetEditor,Widgets,codeSections,ie11,slice=[].slice,bind=function(a,b){return function(){return a.apply(b,arguments)}},indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};console.log("---Blabr",$("html").attr("class")),ie11=/rv:11.0/i.test(navigator.userAgent),("ie"===$("html").attr("class")||ie11)&&alert("IE not currently supported."),("undefined"!=typeof $blab&&null!==$blab?$blab.layoutProcessed:0)||($blab.layoutProcessed=!0,$blab.codeDecoration=!0,Widget=function(){function a(a,b){this.p1=a,this.p2=b,this.used=!1,"string"==typeof this.p1?(this.id=this.p1,this.spec=this.p2,this.spec.id=this.id):(this.spec=this.p1,this.id=this.spec.id),"function"==typeof this.create&&this.create(this.spec)}return a.handle=null,a.register=function(a){return Widgets.register(a)},a.getWidget=function(){return Widgets.Registry[this.name]},a.getApi=function(){return"$blab.Widgets.Registry."+this.name},a.layoutPreamble=function(){var a,b;return a=this.getWidget(),b=this.getApi(),a.handle+" = (id, spec) -> new "+b+"(id, spec)"},a.computePreamble=function(){var a,b;return a=this.getWidget(),b=this.getApi(),a.handle+" = (id, v...) ->\n  "+b+".compute(id, v...)"},a.fetch=function(){var a,b,c;return b=arguments[0],c=2<=arguments.length?slice.call(arguments,1):[],a=this.getWidget(),Widgets.fetch.apply(Widgets,[a,b].concat(slice.call(c)))},a.getVal=function(){var a,b,c;return a=arguments[0],c=2<=arguments.length?slice.call(arguments,1):[],null!=(b=this.fetch.apply(this,[a].concat(slice.call(c))))?b.getVal():void 0},a.setVal=function(){var a,b,c;return a=arguments[0],c=2<=arguments.length?slice.call(arguments,1):[],null!=(b=this.fetch.apply(this,[a].concat(slice.call(c))))&&b.setVal(c),null},a.setValAndGet=function(){var a,b,c;return a=arguments[0],c=2<=arguments.length?slice.call(arguments,1):[],null!=(b=this.fetch.apply(this,[a].concat(slice.call(c))))?b.setVal(c):void 0},a.domIdPrefix=function(){var a;return a=this.getWidget(),a.handle+"-"},a.createDomId=function(a,b){var c;return c=a+b.split(" ").join("-")},a.prototype.appendToCanvas=function(a){return this.mainContainer=a,Widgets.append(this.domId(),this,this.mainContainer)},a.prototype.domId=function(){return a.createDomId(this.constructor.domIdPrefix(),this.id)},a.prototype.select=function(){var a;return a=this.constructor.handle,$.event.trigger("clickWidget",{type:a,id:this.domId(),widget:this})},a.prototype.computeAll=function(){return Widgets.compute()},a.prototype.setUsed=function(a){return null==a&&(a=!0),a!==this.used?(this.mainContainer.css({opacity:a?1:.2}),this.used=a):void 0},a}(),Widgets=function(){function Widgets(){}return Widgets.filename="layout.coffee",Widgets.Registry={},Widgets.register=function(a){var b,c,d;for(console.log("Register",a),d=[],b=0,c=a.length;c>b;b++)Widget=a[b],d.push(this.Registry[Widget.name]=Widget);return d},Widgets.widgets={},Widgets.count=0,Widgets.initialize=function(){return this.Layout=Layout,null==this.widgetEditor&&(this.widgetEditor=new WidgetEditor(this.filename)),$(document).on("aceFilesLoaded",function(a){return function(){var b;if(!a.widgetEditor.editor)return b=$blab.resources.find(a.filename),a.widgetEditor.init(b)}}(this)),$(document).on("preCompileCoffee",function(a){return function(b,c){var d,e;return d=c.resource,e=d.url,a.count=0,e===a.filename?(a.widgetEditor.init(d),a.precode(),a.widgets={}):void 0}}(this)),$(document).on("compiledCoffeeScript",function(a){return function(b,c){var d,e,f,g,h,i;if(c.url===a.filename){if(d=$blab.windowError,$.event.trigger("layoutError",{source:a.filename,error:d}),$.event.trigger("blabError",{source:a.filename,error:d}),d)return void($blab.windowError=!1);for(h=a.widgets,i=e=0,g=h.length;g>e;i=++e)f=h[i],null!=i&&"function"==typeof i.initialize&&i.initialize();return Computation.init(),$.event.trigger("htmlOutputUpdated")}}}(this)),this.queueCompile(2e3)},Widgets.append=function(a,b,c){return this.widgets[a]=b,this.Layout.append(c,b)},Widgets.fetch=function(){var a,b,c,d,e,f,g;return a=arguments[0],b=arguments[1],f=3<=arguments.length?slice.call(arguments,2):[],d=null!=b,d||(b=this.count,this.count++),e=a.domIdPrefix(),c=e?a.createDomId(e,b):b,(g=this.widgets[c])?g:(d?this.createFromId.apply(this,[a,b].concat(slice.call(f))):this.createFromCounter.apply(this,[a,b].concat(slice.call(f))),null)},Widgets.createFromId=function(){var a,b,c,d,e,f,g,h;return a=arguments[0],c=arguments[1],h=3<=arguments.length?slice.call(arguments,2):[],e=$blab.resources.find(this.filename),d=a.handle,g=a.initSpec(c,h),f=g.split("\n").join("\n  "),b=d+' "'+c+'",\n  '+f+"\n",e.containers.fileNodes[0].editor.set(e.content+"\n"+b),this.queueCompile()},Widgets.createFromCounter=function(){var Widget,id,make,spec,v;return Widget=arguments[0],id=arguments[1],v=3<=arguments.length?slice.call(arguments,2):[],spec=Widget.initSpec(id,v),make=function(){return new Widget(id,eval(CoffeeScript.compile(spec,{bare:!0})))},setTimeout(make,700)},Widgets.queueCompile=function(a){var b;return null==a&&(a=500),b=$blab.resources.find(this.filename),this.tCompile&&(clearTimeout(this.tCompile),this.tCompile=null),this.tCompile=setTimeout(function(a){return function(){return b.compile(),$.event.trigger("layoutCompiled")}}(this),a)},Widgets.compute=function(){return Computation.compute()},Widgets.precode=function(){var a,b,c,d,e;c=Layout.shortcuts+"\n",e=this.Registry;for(b in e)a=e[b],c+=a.layoutPreamble()+"\n";return d={},d[this.filename]={preamble:c,postamble:""},$blab.precompile(d)},Widgets.getFromSignature=function(a,b){var c,d,e,f;e=this.Registry;for(c in e)if(Widget=e[c],Widget.handle===a){d=Widget.domIdPrefix(),d&&(b=Widget.createDomId(d,b)),f=this.widgets[b];break}return null!=f?f:null},Widgets.setAllUnused=function(){var a,b,c,d;b=this.widgets,c=[];for(a in b)d=b[a],c.push(d.setUsed(!1));return c},Widgets}(),WidgetEditor=function(){function a(a){this.filename=a,this.firstDisplay=!0,this.currentLine=null,this.viewPortDisplayed=!1,this.sliding=!1,this.next=function(a){return function(){}}(this),this.shown=!1,this.observers={setViewPort:[],clickDelete:[],clickCloseButton:[]}}return a.prototype.init=function(a){var b,c;return this.resource=a,!this.editor&&(this.editor=null!=(b=this.resource.containers)&&null!=(c=b.fileNodes)?c[0].editor:void 0,this.editor)?(this.aceEditor=this.editor.editor,this.setViewPort(null),this.editor.onChange(function(a){return function(){}}(this)),this.aceEditor.setShowFoldWidgets(!0),this.container=this.editor.container,this.parent=this.container.parent(),this.closeButton=new $blab.utils.CloseButton(this.parent,function(a){return function(){return a.trigger("clickCloseButton")}}(this)),this.closeButton.css({right:30})):void 0},a.prototype.setViewPort=function(a){return this.editor?(this.viewPortDisplayed=null!==a,this.trigger("setViewPort"),this.container=this.editor.container,this.parent=this.container.parent(),this.firstDisplay?(this.container.removeClass("init-editor"),this.container.css({maxHeight:"0px"}),this.parent.show(),this.editor.show(!0),a?this.vp(a,!0):setTimeout(function(a){return function(){return a.parent.hide()}}(this),1e3),this.firstDisplay=!1):this.sliding?this.next=function(b){return function(){return b.vp(a),b.next=function(){}}}(this):this.vp(a)):void 0},a.prototype.vp=function(a,b){var c,d,e,f,g,h,i;if(null==b&&(b=!1),this.container.css({maxHeight:"",border:"3px solid #aaf"}),this.start=null,i=this.editor.spec,a)for(c=this.editor.code(),h=c.split("\n"),e=d=0,f=h.length;f>d;e=++d)if(g=h[e],-1!==g.indexOf(a)&&(this.start=e),null!=this.start&&""===g){this.end=e;break}return null===this.start?(this.editor.spec.viewPort=!1,this.sliding=!0,void this.parent.slideUp(400,function(a){return function(){return a.sliding=!1,a.next()}}(this))):(this.parent.hasClass("popup-editor")||this.parent.addClass("popup-editor"),this.parent.css({maxHeight:"0px"}),this.parent.show(),this.deleteButton(),this.errorMessage(),this.start&&this.editor.show(!0),i.viewPort=!0,i.startLine=this.start+1,i.endLine=this.end-this.start+1<20?this.end+1:this.start+20,this.editor.setViewPort(),this.editor.editorContainer[0].onwheel=function(){return!1},this.parent.hide(),this.parent.css({maxHeight:""}),this.sliding=!0,this.parent.slideDown(400,function(a){return function(){return a.sliding=!1,a.next()}}(this)))},a.prototype.deleteButton=function(){var a,b,c;return null!=(a=this.del)&&a.empty(),this.currentId&&(c=Widgets.widgets[this.currentId],!c.used)?((null!=(b=this.del)?b.length:void 0)||(this.del=$("<div>",{css:{position:"absolute",display:"inline-block",top:5,right:15}}),this.editor.editorContainer.append(this.del)),this.delButton=$("<span>",{text:"Delete",css:{cursor:"pointer"},click:function(a){return function(){var b;return b=a.aceEditor.selection,a.start&&a.end?(b.moveCursorTo(a.start-1,0),b.selectTo(a.end,0),a.aceEditor.removeLines(),a.editor.run(),a.parent.hide(),a.trigger("clickDelete")):void 0}}(this)}),this.del.append(this.delButton)):void 0},a.prototype.errorMessage=function(){var a,b;return null!=(a=this.message)&&a.empty(),(null!=(b=this.message)?b.length:void 0)?void 0:(this.message=$("<div>",{css:{position:"absolute",display:"inline-block",top:5,right:15,color:"red"}}),this.editor.editorContainer.append(this.message))},a.prototype.folding=function(){var a,b,c,d;d=$blab.resources.find(this.filename),a=null!=(b=d.containers)&&null!=(c=b.fileNodes)?c[0].editor:void 0,!a},a.prototype.on=function(a,b){return this.observers[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;for(f=this.observers[a],g=[],c=0,d=f.length;d>c;c++)e=f[c],g.push(e(b));return g},a}(),Computation=function(){function a(){}return a.filename="compute.coffee",a.init=function(){var a;return a=this.precode(),this.initialized||$(document).on("allBlabDefinitionsLoaded",function(a){return function(b,c){return a.defs=c.list,a.precode(),a.initialized=!0,a.compute()}}(this)),this.compute()},a.compute=function(){var a;return a=$blab.resources.find(this.filename),null!=a?a.compile():void 0},a.precode=function(){var a,b,c,d,e;c="",e=Widgets.Registry;for(b in e)a=e[b],c+=a.computePreamble()+"\n";return this.defs&&(c+=this.defs+"\n"),d={},d[this.filename]={preamble:c,postamble:""},$blab.precompile(d),!0},a}(),ComputationEditor=function(){function a(){this.setLine=bind(this.setLine,this),this.currentLine=null,this.observers={cursorOnWidget:[]},$("#computation-code-heading").html("Computation <div id='computation-hint' class='code-hint'>Press shift-enter to run</div>"),this.hint=$("#computation-hint"),this.hint.hide(),$(document).on("preCompileCoffee",function(a){return function(b,c){var d,e;return d=c.resource,e=null!=d?d.url:void 0,e===a.filename?a.init(d):void 0}}(this)),$(document).on("compiledCoffeeScript",function(a){return function(b,c){c.url!==a.filename}}(this)),$(document).on("clickComputationButton",function(a){return function(b,c){return a.aceEditor.focus(),a.aceEditor.insert(a.code[c.button]+"\n")}}(this)),$(document).on("runCode",function(a){return function(b,c){return c.filename===a.filename?(a.currentLine=null,setTimeout(function(){return a.setLine()},400)):void 0}}(this)),$(document).on("allBlabDefinitionsLoaded",function(){}),this.changeCursor=function(a){return function(){}}(this)}return a.prototype.filename="compute.coffee",a.prototype.code={slider:'x = slider "x"',plot:'plot "my-plot", x, y',table:'table "my-table", x, y'},a.prototype.init=function(a){var b,c,d;return this.resource=a,!this.editor&&(this.editor=null!=(b=this.resource)&&null!=(c=b.containers)&&null!=(d=c.fileNodes)?d[0].editor:void 0,this.editor)?(this.aceEditor=this.editor.editor,this.currentLine=null,this.selection=this.aceEditor.selection,this.selection.on("changeCursor",function(a){return function(){return a.changeCursor()}}(this))):void 0},a.prototype.initFocusBlur=function(){return this.aceEditor.on("focus",function(a){return function(){return a.setLine(!0),a.changeCursor=function(){return a.setLine()},a.hint.fadeIn()}}(this)),this.aceEditor.on("blur",function(a){return function(){return a.hint.fadeOut(),a.currentLine=null,a.changeCursor=function(){}}}(this))},a.prototype.setLine=function(a){var b,c;return b=null!=(c=this.selection)?c.getCursor():void 0,a||(null!=b?b.row:void 0)!==this.currentLine?(this.currentLine=null!=b?b.row:void 0,this.inspectLineForWidget()):void 0},a.prototype.insertCode=function(a){return this.aceEditor.focus(),this.aceEditor.insert(a)},a.prototype.inspectLineForWidget=function(){var a,b,c,d,e,f,g,h,i,j,k;if(this.editor)return b=this.editor.code(),g=b.split("\n"),f=g[this.currentLine],c=function(){var b,c;b=Widgets.Registry,c=[];for(a in b)Widget=b[a],c.push(Widget.handle);return c}(),d=c.join("|"),k=new RegExp("("+d+') "([^"]*)"',"g"),i=k.exec(f),h=null===i?null:i[0],j=null===i?null:i[1],e=null===i?null:i[2],this.tId&&(clearTimeout(this.tId),this.tId=null),this.tId=setTimeout(function(a){return function(){var b;return b=Widgets.getFromSignature(j,e),a.trigger("cursorOnWidget",{widget:b,match:h})}}(this),200)},a.prototype.on=function(a,b){return this.observers[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;for(f=this.observers[a],g=[],c=0,d=f.length;d>c;c++)e=f[c],g.push(e(b));return g},a}(),ComputationButtons=function(){function a(){var a;this.container=$("#computation-buttons"),a=$("<div>",{css:{display:"inline-block",color:"#aaa",fontSize:"10pt"},text:"Press shift-enter to run"}),this.container.append(a)}return a.prototype.create=function(a){var b;return b=$("<button>",{text:a}),this.container.append(b),b.click(function(){return $.event.trigger("clickComputationButton",{button:a})})},a}(),MarkdownEditor=function(){function a(){this.markdownDiv=bind(this.markdownDiv,this),this.initMarked(),this.text=$(this.containerId),this.text.length&&(this.text.css({cursor:"default"}),this.text.mouseup(function(a){return function(b){return a.trigger("clickText",{evt:b,start:0})}}(this)),this.resources=$blab.resources,this.widgetsRendered=!1,this.firstDisplay=!0,this.viewPortDisplayed=!1,this.observers={initialized:[],setViewPort:[],clickText:[],clickCloseButton:[]})}return a.prototype.containerId="#main-markdown",a.prototype.filename="blab.md",a.prototype.markedUrl="/puzlet/puzlet/js/marked.min.js",a.prototype.posAttr="data-pos",a.prototype.widgetsId="#widgets-container",a.prototype.editorHeight=15,a.prototype.setWidgetsRendered=function(){return this.widgetsRendered=!0,this.initialized?this.process():void 0},a.prototype.initResource=function(){return this.resource=this.resources.find(this.filename),console.log("**** MD",this.resource)},a.prototype.init=function(){var a,b,c;return this.initMarked(),this.initResource(),this.editor=null!=(a=this.resource)&&null!=(b=a.containers)&&null!=(c=b.fileNodes)?c[0].editor:void 0,this.initialized=!0,this.editor?(this.aceEditor=this.editor.editor,this.container=this.editor.container,this.parent=this.container.parent(),this.container.removeClass("init-editor"),this.editor.onChange(function(a){return function(){return a.render()}}(this)),this.editor.show(!1),this.closeButton=new $blab.utils.CloseButton(this.parent,function(a){return function(){return a.trigger("clickCloseButton")}}(this)),this.closeButton.css({right:30}),this.setViewPort(null),this.widgetsRendered&&this.process(),this.trigger("initialized")):void 0},a.prototype.initMarked=function(){return"undefined"!=typeof marked&&null!==marked?(marked.setOptions({renderer:new marked.Renderer,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1}),this.customizeLinks()):void 0},a.prototype.customizeLinks=function(){return marked.Renderer.prototype.link=function(a,b,c){var d,e,f;if(this.options.sanitize){try{e=decodeURIComponent(unescape(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(g){return""}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:"))return""}return f=b?' title="'+b+'"':"",d='<a href="'+a+'" target="_blank"'+f+">"+c+"</a>"}},a.prototype.preProcess=function(a){var b,c,d,e,f,g,h,i,j,k;return g=a.replace(/\\\$/g,"\\&pound;").replace(/\\`/g,"\\&sect;").replace(/([^-])([-]{3})([^-])/g,"$1&mdash;$3"),f=function(a,b,c){var d,e,f,g,h;for(f="",g=0;null!==(e=b.exec(a));)h=a.slice(g,e.index),d=c(e[0]),f+=h+d,g=e.index+e[0].length;return f+=a.slice(g)},c=function(a){return a.replace(/\$/g,function(a){return"\\&yen;"})},b=/(```)([\s\S]*?)(```)|(`)([\s\S]*?)(`)/gm,j=f(g,b,c),e=/[\\`\*_\{\}\[\]\(\)#\+\-\.\!]/g,d=function(a){return a.replace(e,function(a){return"\\"+a})},h=/(\$\$)([\s\S]*?)(\$\$)|(\$)([\s\S]*?)(\$)/gm,k=f(j,h,d),i=k.replace(/\\&pound;/g,"\\$").replace(/\\&sect;/g,"\\`").replace(/\\&yen;/g,"$")},a.prototype.renderMd=function(){var a,b,c,d,e,f;for(this.text.empty(),$(".rendered-markdown").remove(),e=this.snippets(this.preProcess(this.resource.content)),f=[],b=0,c=e.length;c>b;b++)d=e[b],0===d.pos?(this.text.append(d.html),f.push(d.html)):(a=Layout.getContainer(d.pos,d.order),this.markdownDiv(a,d));return this.setTitle(f.join("\n")),$.event.trigger("htmlOutputUpdated")},a.prototype.process=function(){return console.log("MarkdownEditor::process"),this.initialized?(this.renderMd(),this.trigger("setViewPort")):void this.init()},a.prototype.loadMarked=function(a){return console.log("MarkdownEditor::loadMarked"),this.resources.add({url:this.markedUrl}),this.resources.loadUnloaded(function(){return"function"==typeof a?a():void 0})},a.prototype.markdownDiv=function(a,b){var c;return c=$("<div>",{"class":"rendered-markdown",css:{cursor:"default"},mouseup:function(a){return function(b){return a.trigger("clickText",{evt:b,start:parseInt(c.attr("data-start"))})}}(this)}),c.attr({"data-pos":b.pos,"data-order":b.order,"data-start":b.start}),c.append(b.html),a.append(c),c},a.prototype.setTitle=function(){var a;return a=$(":header"),$blab.title=a.length?a[0].innerHTML:"Puzlet",console.log("MarkdownEditor::setTitle",$blab.title),"Untitled"!==$blab.title?document.title=$blab.title:void 0},a.prototype.setViewPort=function(a){return this.editor?(this.viewPortDisplayed=null!==a&&a!==!1,this.trigger("setViewPort"),this.container=this.editor.container,this.parent=this.container.parent(),this.firstDisplay?(this.container.removeClass("init-editor"),this.container.css({maxHeight:"0px"}),this.parent.show(),this.editor.show(!0),setTimeout(function(b){return function(){return b.vp(a,!0)}}(this),500),this.firstDisplay=!1):this.vp(a)):void 0},a.prototype.vp=function(a,b){var c;return null==b&&(b=!1),this.container.css({maxHeight:"",border:"3px solid #aaf"}),c=this.editor.spec,c.viewPort=!0,null===a||a===!1?(c.startLine=1,c.endLine=this.editorHeight,this.editor.setViewPort(),void(b?(this.editor.show(!1),this.parent.hide()):this.parent.slideUp(400))):(this.parent.hasClass("popup-editor")||this.parent.addClass("popup-editor"),this.start=0===a?0:this.getStartLine(a),this.end=this.start+this.editorHeight-1,b?this.parent.show():this.parent.slideDown(400),this.editor.show(!0),c.startLine=this.start+1,c.endLine=this.end+1,this.editor.setViewPort())},a.prototype.getStartLine=function(a){var b,c,d,e,f,g,h;for(b=this.editor.code(),h=b.split("\n"),e=0,d=c=0,f=h.length;f>c&&(g=h[d],e+=g.length+1,!(e>a));d=++c);return d-1},a.prototype.render=function(){return null==this.renderId&&(this.renderId=null),this.renderId&&clearTimeout(this.renderId),this.renderId=setTimeout(function(a){return function(){return a.process()}}(this),500)},a.prototype.snippets=function(a){var b,c,d,e;for(null==this.RE&&(this.RE=/^\s*`\s*(?:p|pos)\s*:\s*(\d+)\s*,?\s*(?:(?:o|ord|order)\s*:\s*(\d+)\s*)?.*`.*$/gm),d=[],e=function(b){var c,d,e,f,g;return g=null!=(c=b.start)?c:0,f=a.slice(g,+b.end+1||9e9),{start:g,pos:parseInt(null!=(d=b.pos)?d:0),order:parseInt(null!=(e=b.order)?e:1),source:f,html:marked(f)}},b={};null!==(c=this.RE.exec(a));)b.end=c.index-1,d.push(e(b)),b={start:c.index+c[0].length+1,pos:c[1],order:c[2]};return b.end=-1,d.push(e(b)),d},a.prototype.on=function(a,b){return this.observers[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;for(f=this.observers[a],g=[],c=0,d=f.length;d>c;c++)e=f[c],g.push(e(b));return g},a}(),Layout=function(){function a(){}return a.shortcuts="layout = (spec) -> $blab.Widgets.Layout.set(spec)\nsettings = (spec) -> $blab.blabrApp.setSettings(spec)\npos = (spec) -> $blab.Widgets.Layout.pos(spec)\ntext = (spec) -> $blab.Widgets.Layout.text(spec)",a.spec={},a.currentContainer=null,a.observers={renderedWidgets:[],clickBox:[]},a.set=function(a){return this.spec=a,this.render()},a.pos=function(a){this.currentContainer=a},a.render=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;if(Array.isArray(this.spec))return void this.renderFromArray();if(Object.keys(this.spec).length){h=1,m=$("#widgets-container"),m.empty(),k=this.spec;for(f in k){for(l=k[f],j=$("<div>",{id:f}),m.append(j),d=0,g=l.length;g>d;d++)for(b=l[d],a=$("<div>",{"class":b,mouseup:function(a){return function(b){return a.trigger("clickBox",{evt:b})}}(this)}),a.addClass("layout-box"),this.appendNum(a,h),h++,j.append(a),c=e=1;5>=e;c=++e)i=$("<div>",{"class":"order-"+c}),a.append(i);j.append($("<div>",{"class":"clear"}))}return(WidgetEditor.viewPortDisplayed||MarkdownEditor.viewPortDisplayed)&&this.highlight(),this.trigger("renderedWidgets")}},a.renderFromArray=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(this.spec.length){for(j=1,q=$("#widgets-container"),q.empty(),n=this.spec,p=f=0,i=n.length;i>f;p=++f){for(k=n[p],k>4&&(console.log("Maximum of 4 columns per row"),k=4),m=$("<div>",{id:"widget-row-"+(p+1)}),q.append(m),d=g=1,o=k;o>=1?o>=g:g>=o;d=o>=1?++g:--g)for(b="widget-box-"+j,a="box-"+k+"-"+d,c=$("<div>",{id:b,"class":a,mouseup:function(a){return function(b){return a.trigger("clickBox",{evt:b})}}(this)}),c.addClass("layout-box"),m.append(c),this.appendNum(c,j),j++,e=h=1;5>=h;e=++h)l=$("<div>",{"class":"order-"+e}),c.append(l);m.append($("<div>",{"class":"clear"}))}return(WidgetEditor.viewPortDisplayed||MarkdownEditor.viewPortDisplayed)&&this.highlight(),this.trigger("renderedWidgets")}},a.appendNum=function(a,b){var c;return c=$("<div>",{text:b,"class":"layout-box-number",css:{marginLeft:a.width()-23}}),a.append(c),c.hide()},a.highlight=function(a){return null==a&&(a=!0),a?($(".layout-box").addClass("layout-highlight"),$(".layout-box-number").show()):($(".layout-box-number").hide(),$(".layout-box").removeClass("layout-highlight"))},a.append=function(a,b){var c;return c=null!=(null!=b?b.spec.pos:void 0)?this.getContainer(b.spec.pos,b.spec.order):$(this.currentContainer),c.append(a)},a.getContainer=function(a,b){var c,d;return d=$.isNumeric(a)?"#widget-box-"+a:a,c=$(d),null!=b&&(c=$(c).find(".order-"+b)),c},a.text=function(a){return this.append(a)},a.on=function(a,b){return this.observers[a].push(b)},a.trigger=function(a,b){var c,d,e,f,g;for(f=this.observers[a],g=[],c=0,d=f.length;d>c;c++)e=f[c],g.push(e(b));return g},a}(),Definitions=function(){function a(a){this.done=a,this.resources=$blab.resources,this.coffee=this.resources.add({url:this.filename}),$blab.definitions={},$blab.use=function(a){return function(b,c){return null==b&&(b=null),a.use(b,c)}}(this),this.allLoaded=!1,$blab.defs={},$blab.mainDefs=function(a){return function(b){return a.main(b)}}(this),this.precode(this.filename),$(document).on("preCompileCoffee",function(a){return function(b,c){var d,e;return d=c.resource,e=d.url,e===a.filename?($blab.defs={},$blab.definitions={},a.allLoaded=!1):void 0}}(this)),this.resources.loadUnloaded(function(a){return function(){return a.setHeading(),a.coffee.compile()}}(this))}return a.prototype.filename="defs.coffee",a.prototype.setHeading=function(){return $("#defs-code-heading").html("Definitions <div id='defs-hint' class='code-hint'>Press shift-enter to run</div>"),this.hint=$("#defs-hint"),this.hint.hide()},a.prototype.main=function(a){return"string"==typeof a?void this.directDefs(a):($blab.definitions[this.filename]=a,a.loaded=!0,$blab.defs=a,this.checkLoaded(a),a)},a.prototype.directDefs=function(a){var b;return b=this.use(a),this.main({derived:function(){var a,c,d;d=[];for(a in b)c=b[a],"loaded"!==a&&"isImport"!==a?d.push(this[a]=c):d.push(void 0);return d}})},a.prototype.use=function(a,b){var c,d,e;return null==a&&(a=null),e=(a?a+"/":"")+this.filename,null==(c=$blab.definitions)[e]&&(c[e]={}),d=$blab.definitions[e],null==d.isImport&&(d.isImport=!0),null==d.loaded&&(d.loaded=!1),d.loaded?setTimeout(function(a){return function(){return a.checkLoaded(d)}}(this),0):this.loadCoffee(e,function(a){return function(){return"function"==typeof b&&b(d),a.getDefs(e,d)}}(this)),d},a.prototype.getDefs=function(a,b){var c,d,e;c=$blab.definitions[a],c.loaded=!0;for(e in c)d=c[e],b[e]=d;return this.checkLoaded(b)},a.prototype.checkLoaded=function(a){var b,c,d,e,f,g;if(!this.allLoaded){if(!a.loaded)return!1;c=!0;for(e in a)d=a[e],d.isImport&&!d.loaded&&(c=!1);if(!c)return!1;f=$blab.definitions;for(g in f)if(b=f[g],!b.loaded)return!1;return this.allDone(),!0}},a.prototype.allDone=function(){return this.processDerived($blab.defs),this.allLoaded=!0,null!=this.firstDone?$.event.trigger("allBlabDefinitionsLoaded",{list:this.list()}):this.done(function(a){return function(){return a.firstDone=!0,$.event.trigger("allBlabDefinitionsLoaded",{list:a.list()})}}(this))},a.prototype.processDerived=function(a){var b,c;for(c in a)b=a[c],b.isImport&&this.processDerived(b);return"function"==typeof a.derived?a.derived():void 0},a.prototype.list=function(){var a,b,c,d,e;a=[],console.log("$blab.defs",$blab.defs),e=$blab.defs;for(d in e)b=e[d],"loaded"!==d&&"derived"!==d&&a.push(d);return c=a.join(", "),"{"+c+"} = $blab.defs"},a.prototype.initEditor=function(){var a,b;return this.editor=null!=(a=this.coffee.containers)&&null!=(b=a.fileNodes)?b[0].editor:void 0,this.aceEditor=this.editor.editor,this.aceEditor.on("focus",function(a){return function(){return a.hint.fadeIn()}}(this)),this.aceEditor.on("blur",function(a){return function(){return a.hint.fadeOut()}}(this))},a.prototype.loadCoffee=function(a,b){var c,d,e,f,g,h,i,j,k,l;for(k=this.resources.resources,g=f=0,h=k.length;h>f;g=++f)j=k[g],j.url===a&&(d=g);if(d&&k.splice(d,1),0===a.indexOf("gist")){if(l=/^gist:([a-z0-9_-]+)/,i=l.exec(a),!i)return;return e=i[1],void this.gist(e,function(c){return function(d){var e,f;return f=d.defs,e=c.resources.add({url:a,source:f}),e.gistData=d,e.location.inBlab=!1,c.doLoad(e,b)}}(this))}return c=this.resources.add({url:a}),this.doLoad(c,b)},a.prototype.doLoad=function(a,b){var c;return c=a.url,this.precode(c),this.resources.load(function(a){return a.url===c},function(c){return function(){return a.compile(),"function"==typeof b?b():void 0}}(this))},a.prototype.precode=function(a){var b,c;return b='blabId = "'+a+'"\nuse = (id, callback) -> $blab.use(id, callback)\ndefs = (d) ->\n  if blabId is "defs.coffee"\n    return $blab.mainDefs(d)\n  else\n    $blab.definitions[blabId] = d\n    return d\n\n\n',c={},c[a]={preamble:b,postamble:""},$blab.precompile(c)},a.prototype.gist=function(a,b){var c,d;return c="https://api.github.com/gists",d=c+"/"+a,$.get(d,function(a){return function(a){var c,d,e,f,g,h;return c=null!=(f=null!=(g=a.files)&&null!=(h=g["defs.coffee"])?h.content:void 0)?f:null,d=a.description,e=a.owner.login,"function"==typeof b?b({defs:c,description:d,owner:e}):void 0}}(this))},a}(),Buttons=function(){function a(a){var b,c,d,e,f,g,h,i;this.spec=a,this.container=$("#buttons"),this.resources=$blab.resources,this.isGist=null!=this.resources.getSource,this.isDemo=this.isGist&&this.resources.getSource("demo.coffee"),this.isStart=!this.isGist,this.isBlab=this.isGist&&!this.isDemo,this.settings=this.spec.getSettings(),i=function(){return $("#computation-code-wrapper").show()},((null!=(c=this.settings)?c.showCodeOnLoad:void 0)||(this.isStart||this.isDemo)&&null==(null!=(d=this.settings)?d.showCodeOnLoad:void 0))&&i(),this.isStart&&((null!=(e=this.settings)?e.showCodeOnLoad:void 0)&&i(),this.startButtons()),this.isBlab&&($("#top-banner").slideUp(),(null!=(f=this.settings)?f.showCodeOnLoad:void 0)&&i(),this.append("<hr>"),this.logo(),this.docButton(),this.sep(),this.sourceButton(),this.sep(),this.revisionsButton(),this.sep(),this.showForkButton(),this.sep(),this.commentsButton(),this.sep(),b=this.linkButton("Edit Page",function(a){return function(){return a.makeEditable()}}(this)),b.css({color:"green",fontWeight:"bold",textDecoration:"none"}),b.attr({title:"Edit blab's layout, text, and widgets."}),(null!=(g=this.settings)?g.showAuthor:void 0)&&this.author()),this.isDemo&&($("#top-banner").slideUp(),(null==this.settings||(null!=(h=this.settings)?h.showCodeOnLoad:void 0)===!0)&&i(),this.makeEditable())}return a.prototype.logo=function(){var a,b;return b=$("<div>",{id:"blabr-logo-footer",click:function(a){return function(){return a.spec.guide()}}(this)}),a=$("<img>",{src:"img/blabr-logo.png"}),b.append(a).append("Blabr"),this.append(b)},a.prototype.startButtons=function(){return this.container.empty(),this.append("<hr>"),this.logo(),this.docButton()},a.prototype.makeEditable=function(){return this.isStart?void 0:($("#computation-code-wrapper").show(500),this.spec.makeEditable(),this.startButtons(),this.appendBlabButtons(),this.author())},a.prototype.appendBlabButtons=function(){var a;return this.sep(),this.sourceButton(),this.sep(),this.revisionsButton(),this.sep(),this.showForkButton(),this.sep(),this.commentsButton(),this.sep(),a=this.linkButton("Settings",function(a){return function(){return console.log("settings"),a.spec.editSettings()}}(this)),a.attr({title:"Edit blab settings."})},a.prototype.docButton=function(){return this.linkButton("Doc & Examples",function(a){return function(){return a.spec.guide()}}(this))},a.prototype.sourceButton=function(){var a,b;return a=this.linkButton("Source Control",function(){},null!=(b=$blab.github)?b.sourceLink():void 0),a.attr({title:"View GitHub Gist page for this blab."})},a.prototype.revisionsButton=function(){var a,b;return a=this.linkButton("Revisions",function(){},(null!=(b=$blab.github)?b.sourceLink():void 0)+"/revisions"),a.attr({title:"View GitHub Gist revisions for this blab."})},a.prototype.commentsButton=function(){var a,b;return a=this.linkButton("Comment",function(){},(null!=(b=$blab.github)?b.sourceLink():void 0)+"#comments"),a.attr({title:"Comment on this blab in GitHub Gist page."})},a.prototype.showForkButton=function(){var a;return a=this.forkButton=this.linkButton("Fork",function(a){return function(){var a,b;return a=!0,null!=(b=$blab.github)?b.save(a):void 0}}(this)),a.attr({title:"Create your own version of this blab."})},a.prototype.author=function(){var a,b,c,d,e;return(c=null!=(d=$blab.github)&&null!=(e=d.gist)?e.gistOwner:void 0)?(b=$("<div>",{id:"blab-author",text:"Author: ",css:{"float":"right"}}),a=$("<a>",{text:"@"+c,href:"//gist.github.com/"+c,target:"_blank",css:{textDecoration:"none"}}),b.append(a),this.container.append(b)):void 0},a.prototype.createButton=function(a){var b;return b=$("<button>",{text:a}),this.append(b),b},a.prototype.linkButton=function(a,b,c){var d;return d=$("<a>",{click:function(){return"function"==typeof b?b():void 0},text:a,target:"_blank"}),c&&d.attr({href:c}),this.append(d),d},a.prototype.append=function(a){return this.container.append(a)},a.prototype.sep=function(){return this.append(" | ")},a}(),EditPageButton=function(){function a(a,b){this.container=a,this.callback=b,this.div=$("<div>",{id:"edit-page-button-container",css:{position:"fixed",bottom:20,right:10,zIndex:300}}),this.b=$("<a>",{id:"edit-page-button",click:function(a){return function(){return a.b.button("refresh"),"function"==typeof a.callback?a.callback():void 0}}(this)}),this.b.button({label:"Layout"}),this.div.append(this.b),this.container.append(this.div),this.hide()}return a.prototype.show=function(){return this.b.show()},a.prototype.hide=function(){return this.b.hide()},a}(),Errors=function(){function a(){var a;this.container=$(this.containerSel),this.filenames=function(){
var b;b=[];for(a in this.errors)b.push(a);return b}.call(this),window.onerror=function(a){return function(a,b,c){return $blab.windowError=a}}(this),$(document).on("preCompileCoffee",function(a){return function(b,c){return a.reset(c.resource.url)}}(this)),$(document).on("blabError",function(a){return function(b,c){var d;return d=c.source,a.enable&&indexOf.call(a.filenames,d)>=0?($blab.windowError=!1,a.set(d,c.error),a.disp()):void 0}}(this))}return a.prototype.errors={"compute.coffee":{heading:"Computation",error:null},"defs.coffee":{heading:"Definitions",error:null},"layout.coffee":{heading:"Layout",error:null}},a.prototype.containerSel="#blab-error",a.prototype.enable=!0,a.prototype.reset=function(a){var b,c,d,e;d=this.errors,e=[];for(c in d)b=d[c],a===c?e.push(this.errors[c].error=null):e.push(void 0);return e},a.prototype.set=function(a,b){var c,d,e,f;e=this.errors,f=[];for(d in e)c=e[d],a===d?f.push(this.errors[d].error=b?b:null):f.push(void 0);return f},a.prototype.disp=function(){var a,b,c,d,e,f,g;this.container.empty(),new $blab.utils.CloseButton(this.container,function(a){return function(){return a.container.hide()}}(this)),c=!0,f=!1,g="",e=this.errors;for(d in e)a=e[d],b=a.error,b&&(f=!0,c||(g+="<br><br>"),g+="<b>"+a.heading+"</b><br>"+b,c=!1);return this.container.append(g),f?this.container.show():this.container.hide()},a}(),Loader=function(){function a(a){var b,c,d,e,f;this.init=a,this.resources=$blab.resources,this.resources.blockPostLoadFromSpecFile=!0,d=this.resources.add({url:"layout.coffee"}),e=this.resources.add({url:"blab.md"}),f=this.resources.add({url:"tables.json"}),(null==this.resources.getSource||this.resources.getSource("demo.coffee"))&&(b=this.resources.add({url:"demo.coffee"}),c=function(){return $blab.initDemoRunner(),b.compile()}),this.resources.loadUnloaded(function(a){return function(){return a.definitions=new Definitions(function(b){return a.init(),d.compile(),$blab.blabrGuide=new $blab.guideClass,"function"==typeof c&&c(),a.resources.postLoadFromSpecFile(),b()})}}(this))}return a}(),BlabEvents=function(){function a(){this.body=$(document.body),this.body.mousedown(function(a){return function(b){return a.trigger("blabmousedown")}}(this)),this.body.mouseup(function(a){return function(b){return a.trigger("blabmouseup")}}(this)),document.body.addEventListener("copy",function(a){return function(b){return a.trigger("blabcopy",{original:b})}}(this)),this.unbind(["blabcompute"]),this.on("preCompileCoffee",function(a){return function(b,c){return a.unbinds(c.resource.url)}}(this)),this.on("compiledCoffeeScript",function(a){return function(b,c){return a.triggers(c.url)}}(this))}return a.prototype.unbinds=function(a){return"layout.coffee"===a&&this.unbind(["blabcompute"]),this.unbind(["blabmousedown","blabmouseup","blabcopy","blabpaste"])},a.prototype.triggers=function(a){var b,c;return b="compute.coffee"===a,c="layout.coffee"===a,b||c||this.trigger("blabError",{source:a,error:$blab.windowError}),b?this.trigger("blabcompute"):void 0},a.prototype.on=function(a,b){return $(document).on(a,function(a,c){return b(a,c)})},a.prototype.trigger=function(a,b){return $.event.trigger(a,b)},a.prototype.unbind=function(a){var b,c,d,e;for(e=[],c=0,d=a.length;d>c;c++)b=a[c],e.push($(document).unbind(b));return e},a}(),Background=function(){function a(a){a&&screen.width>=1024?($(document.body).css({backgroundImage:"url("+a+")"}),$("#outer-container").addClass("outer-background"),$("#outer-container").css({marginTop:30,paddingTop:10}),$("#container").css({marginTop:20})):($(document.body).css({backgroundImage:""}),$("#outer-container").removeClass("outer-background"),$("#outer-container").css({marginTop:0,paddingTop:0}),$("#container").css({marginTop:40}))}return a}(),Settings=function(){function a(){}return a.prototype.set=function(a){var b,c,d,e,f;return this.spec=a,new Background(null!=(c=this.spec)?c.background:void 0),b=$("#blab-author"),this.spec.showAuthor=null==(null!=(d=this.spec)?d.showAuthor:void 0)||(null!=(e=this.spec)?e.showAuthor:void 0),b.length?(null!=(f=this.spec)?f.showAuthor:void 0)?b.show():b.hide():void 0},a}(),PopupEditorManager=function(){function a(a){var b;this.spec=a,this.highlightWidget=bind(this.highlightWidget,this),b=this.spec,this.widgetEditor=b.widgetEditor,this.markdownEditor=b.markdownEditor,this.layoutEnabled=!1,this.clickedOnComponent=!1,this.currentComponent=null,this.markdownEditor.on("clickText",function(a){return function(b){var c;return"A"===(null!=(c=b.evt)?c.target.tagName:void 0)?void b.evt.stopPropagation():a.showMarkdownEditor(b.start)}}(this)),this.markdownEditor.on("setViewPort",function(a){return function(){return a.highlightLayout()}}(this)),this.markdownEditor.on("clickCloseButton",function(a){return function(){return a.disableLayout()}}(this)),this.widgetEditor.on("setViewPort",function(a){return function(){return a.highlightLayout()}}(this)),this.widgetEditor.on("clickCloseButton",function(a){return function(){return a.disableLayout()}}(this)),this.widgetEditor.on("clickDelete",function(a){return function(){return a.clickedOnComponent=!0}}(this)),this.on("clickWidget",function(a){return function(b,c){return a.showLayoutEditor({widget:c.widget})}}(this)),Layout.on("clickBox",function(a){return function(b){return"editable-table-cell"!==b.evt.target.className?a.showLayoutEditor({signature:"layout"}):void 0}}(this)),$(document.body).click(function(a){return function(b){return a.hideAll(b)}}(this)),this.on("clickInputWidget",function(a){return function(b,c){return a.hideLayout()}}(this)),this.editPageButton=new EditPageButton($("#edit-page"),function(a){return function(){return a.enableLayout()}}(this))}return a.prototype.enableLayout=function(){return this.enable(),this.showLayoutEditor({signature:"layout",clicked:!0})},a.prototype.disableLayout=function(){return this.enable(!1),this.hideLayout()},a.prototype.enable=function(a){return null==a&&(a=!0),a&&(this.initEnabled=!0),this.layoutEnabled=a},a.prototype.cursorOnWidget=function(a){return this.showLayoutEditor({widget:a,id:null,clicked:!1})},a.prototype.showMarkdownEditor=function(a){return console.log("showMarkdownEditor",this.layoutEnabled),this.layoutEnabled?(this.clickedOnComponent=!0,setTimeout(function(a){return function(){return a.clickedOnComponent=!1}}(this),300),this.highlightWidget(null),this.widgetEditor.setViewPort(null),this.markdownEditor.setViewPort(a)):void 0},a.prototype.showLayoutEditor=function(a){var b,c,d,e,f,g,h,i;if(this.layoutEnabled&&!this.clickedOnComponent)return i=a.widget,g=null!=(d=a.signature)?d:null,b=null!=(e=a.clicked)?e:!0,i&&(h=i.constructor.handle,c=i.id,g=h+" "+('"'+c+'"')),b&&(this.clickedOnComponent=!0,setTimeout(function(a){return function(){return a.clickedOnComponent=!1}}(this),300)),this.widgetEditor.setViewPort(g),this.markdownEditor.setViewPort(null),this.highlightWidget(null!=(f=null!=i?i.mainContainer:void 0)?f:null),i&&(this.widgetEditor.currentId=i.domId()),g?this.editPageButton.hide():void 0},a.prototype.highlightLayout=function(){var a;return a=this.widgetEditor.viewPortDisplayed||this.markdownEditor.viewPortDisplayed,Layout.highlight(a),a?this.editPageButton.hide():void 0},a.prototype.hideLayout=function(){return this.highlightWidget(null),this.widgetEditor.setViewPort(null),this.markdownEditor.setViewPort(null),this.layoutEnabled?this.editPageButton.hide():this.initEnabled?setTimeout(function(a){return function(){return a.editPageButton.b.fadeIn(500)}}(this),500):void 0},a.prototype.highlightWidget=function(a){var b,c;return null!=(b=this.currentComponent)&&b.removeClass("widget-highlight"),this.currentComponent=a,null!=(c=this.currentComponent)?c.addClass("widget-highlight"):void 0},a.prototype.hideAll=function(a){return setTimeout(function(b){return function(){return b.clickedOnComponent||$(a.target).attr("class")||b.hideLayout(),b.clickedOnComponent=!1}}(this),100)},a.prototype.on=function(a,b){return $(document).on(a,function(a,c){return b(a,c)})},a}(),GoogleAnalytics=function(){function a(){var a;this.codeChanged=!1,a=function(){var b,c,d;return b=null!=(c=$blab.github)&&null!=(d=c.gist)?d.id:void 0,a="Untitled"!==$blab.title||b?$blab.title:"---Home Page---",b?a+" ["+b+"]":a},this.track("blabEditorsInitialized","blab","view",a),this.track("codeNodeChanged","blab","firstEdit",a,function(a){return function(){return!a.codeChanged}}(this),function(a){return function(){return a.codeChanged=!0}}(this)),this.track("saveGitHub","blab","saveButton",a),this.track("createBlab","blab","createBlab",a),this.track("forkBlab","blab","forkBlab",a),this.track("runBlabDemo","blab","runDemo",a)}return a.prototype.track=function(a,b,c,d,e,f){return null==e&&(e=function(){return!0}),$(document).on(a,function(a){return function(){var a;return a=d(),e()&&"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent",b,c,a]),"function"==typeof f?f():void 0}}(this))},a}(),App=function(){function a(){new GoogleAnalytics,console.log("*** BROWSER",$("html").attr("class")),this.loader=new Loader(function(a){return function(){return a.init()}}(this))}return a.prototype.init=function(){return new BlabEvents,Widgets.initialize(),this.widgetEditor=Widgets.widgetEditor,this.computationEditor=new ComputationEditor,this.markdownEditor=new MarkdownEditor,this.definitions=this.loader.definitions,this.on("aceFilesLoaded",function(a){return function(){return a.initEditors()}}(this)),this.beforeCompute(function(a){return function(){return Computation.precode(),Widgets.setAllUnused()}}(this)),Layout.on("renderedWidgets",function(a){return function(){return a.markdownEditor.initResource(),a.markdownEditor.renderMd(),a.markdownEditor.setWidgetsRendered()}}(this)),$("#computation-code-wrapper").hide(),this.on("layoutCompiled",function(a){return function(){return a.initButtons()}}(this)),this.on("codeNodeChanged",function(a){return function(){return a.changed?void 0:(a.changed=!0,a.buttons.makeEditable())}}(this)),this.settingsObj=new Settings,this.errors=new Errors,$pz.renderHtml=function(a){return function(){return a.markdownEditor.process()}}(this)},a.prototype.initEditors=function(){return this.markdownEditor.process(),this.definitions.initEditor(),this.editors=new PopupEditorManager({widgetEditor:this.widgetEditor,markdownEditor:this.markdownEditor}),this.computationEditor.on("cursorOnWidget",function(a){return function(b){var c,d;if((null==(null!=(c=a.settings)?c.popupWidgetEditor:void 0)||(null!=(d=a.settings)?d.popupWidgetEditor:void 0))&&!a.disablePopupWidgetEditor)return a.editors.cursorOnWidget(b.widget)}}(this)),setTimeout(function(a){return function(){return a.computationEditor.initFocusBlur()}}(this),900),this.markdownEditor.on("initialized",function(a){return function(){return $.event.trigger("blabEditorsInitialized")}}(this)),null==$blab.resources.getSource?this.editors.enable():void 0},a.prototype.initButtons=function(){return this.buttons?void 0:this.buttons=new Buttons({guide:function(a){return function(){return $blab.blabrGuide.slideToggle()}}(this),makeEditable:function(a){return function(){var b;return null!=(b=a.editors)?b.enable():void 0}}(this),editSettings:function(a){return function(){var b,c;return null!=(b=a.editors)&&b.enable(),null!=(c=a.editors)?c.showLayoutEditor({signature:"settings"}):void 0}}(this),getSettings:function(a){return function(){return a.settings}}(this)})},a.prototype.setSettings=function(a){return this.settings=a,this.settingsObj.set(this.settings)},a.prototype.beforeCompute=function(a){return this.on("preCompileCoffee",function(b){return function(b,c){return"compute.coffee"===c.resource.url?a():void 0}}(this))},a.prototype.forceEditorRendering=function(){return setTimeout(function(a){return function(){var b;return null!=(b=a.computationEditor.aceEditor)&&b.focus(),setTimeout(function(){var b;return null!=(b=a.computationEditor.aceEditor)&&b.blur(),a.definitions.aceEditor.focus(),setTimeout(function(){return a.definitions.aceEditor.blur(),a.computationEditor.initFocusBlur()},300)},300)}}(this),300)},a.prototype.on=function(a,b){return $(document).on(a,function(a,c){return b(a,c)})},a}(),$blab.AppClass=App,$blab.Layout=Layout,$blab.Widget=Widget,$blab.Widgets=Widgets,codeSections=function(){var a,b,c,d,e,f,g;return f="Show/hide code",a=$("#computation-code-section"),b=$("#layout-code-section"),c=$(".predefined-code"),c.hide(),$("#computation-code-heading").click(function(){return a.toggle(500)}),$("#layout-code-heading").click(function(){return b.toggle(500)}),d=!0,g=function(){return d=!d},g(),e=function(){var a,b,c,d,e,f,g;return g=$blab.resources.find("predefine.coffee"),a=null!=g&&null!=(c=g.containers)&&null!=(d=c.fileNodes)?d[0].editor:void 0,null!=a&&a.container.removeClass("init-editor"),b=null!=g&&null!=(e=g.containers)&&null!=(f=e.evalNodes)?f[0].editor:void 0,null!=b?b.container.removeClass("init-editor"):void 0},$("#predefined-code-heading").click(function(){return e(),c.toggle(500),g()})},TextEditor=function(){function a(){this.text=$(this.containerId),this.text.length&&(this.text.css({cursor:"default"}),this.text.click(function(a){return function(){return a.toggle()}}(this)),this.resources=$blab.resources,this.widgetsRendered=!1)}return a.prototype.containerId="#main-text",a.prototype.filename="text.html",a.prototype.wikyUrl="/puzlet/puzlet/js/wiky.js",a.prototype.posAttr="data-pos",a.prototype.widgetsId="#widgets-container",a.prototype.setWidgetsRendered=function(){return this.widgetsRendered=!0,"undefined"!=typeof Wiky&&null!==Wiky?this.process():void 0},a.prototype.loadWiky=function(a){return console.log("TextEditor::loadWiky"),this.resources.add({url:this.wikyUrl}),this.resources.loadUnloaded(function(){return"function"==typeof a?a():void 0})},a.prototype.init=function(){var a,b,c;return console.log("TextEditor::init"),this.resource=this.resources.find(this.filename),this.editor=null!=(a=this.resource)&&null!=(b=a.containers)&&null!=(c=b.fileNodes)?c[0].editor:void 0,this.editor?(this.editor.container.removeClass("init-editor"),this.editor.onChange(function(a){return function(){return a.render()}}(this)),this.editor.show(!1),this.widgetsRendered?this.process():void 0):void 0},a.prototype.render=function(){return null==this.renderId&&(this.renderId=null),this.renderId&&clearTimeout(this.renderId),this.renderId=setTimeout(function(a){return function(){return a.process()}}(this),500)},a.prototype.process=function(){var a;return console.log("TextEditor::process"),"undefined"==typeof Wiky||null===Wiky?void this.loadWiky(function(a){return function(){return a.init()}}(this)):(console.log("TextEditor::process/Wiky"),this.text.empty(),a=Wiky.toHtml(this.resource.content),""!==a?(this.text.append(a),this.setTitle(),this.positionText(),$.event.trigger("htmlOutputUpdated")):void 0)},a.prototype.setTitle=function(){var a;return a=$(":header"),a.length?($blab.title=a[0].innerHTML,document.title=$blab.title):void 0},a.prototype.positionText=function(){var a,b,c,d,e;return d="div["+this.posAttr+"]",e=$(this.widgetsId),b=e.find(d),b.remove(),c=this.text.find(d),c.length?(a=function(a){return function(){var b,d,e,f;for(f=[],b=0,d=c.length;d>b;b++)e=c[b],f.push($($(e).attr(a.posAttr)).append($(e)));return f}}(this),e.length?a():setTimeout(function(){return a()},1e3)):void 0},a.prototype.toggle=function(){return this.editor?(null==this.editorShown&&(this.editorShown=!1),this.editor.show(!this.editorShown),this.editorShown=!this.editorShown):void 0},a}())}).call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=function(a,b){return function(){return a.apply(b,arguments)}},y=function(a,b){function c(){this.constructor=a}for(var d in b)z.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},z={}.hasOwnProperty,A=[].slice;console.log("-------------Demo runner"),i=function(){function a(a){this.runDemo=a,this.container=$("#demo-start-button-area"),this.container.addClass("demo-start-button-main"),$("#main-markdown").css({opacity:0})}return a.prototype.clear=function(a){return this.button.clear(),this.container.slideUp(1e3,function(b){return function(){return $("#top-banner").slideUp(400,function(){return $("#main-markdown").animate({opacity:1},1500,function(){return"function"==typeof a?a():void 0})})}}(this))},a.prototype.create=function(){var a;return a=$("<img>",{id:"demo-start-button-main-image",src:"img/blab.png"}),this.div=$("<div>",{"class":"demo-start-button-main-text"}),this.div.append("<h1>Scientific computing for the web.</h1>"),this.container.append(a).append(this.div)},a.prototype.activate=function(){return this.container.click(function(a){return function(){return a.clear(function(){return a.runDemo()})}}(this)),this.button=new k(this.div,function(a){return function(){}}(this))},a.prototype.logo=function(){return this.logoContainer=$("<div>",{id:"blabr-logo"}),this.div.append(this.logoContainer),this.logo=$("<img>",{src:"img/blabr-logo.png",height:60}),this.logoContainer.append(this.logo).append("<p>Blabr</p>")},a}(),d=function(){function a(a){this.runDemo=a,this.container=$("#demo-start-button-area"),this.container.css({height:80})}return a.prototype.clear=function(a){return this.button.clear(),this.container.slideUp(1e3,function(){return"function"==typeof a?a():void 0})},a.prototype.create=function(){return this.button=new k(this.container,function(a){return function(){return a.clear(function(){return a.runDemo()})}}(this))},a}(),k=function(){function a(a,b){this.container=a,this.callback=b,this.button=$("<img>",{src:"img/play.png",css:{height:60,cursor:"pointer"},click:function(a){return function(){return a.clicked?void 0:(a.clicked=!0,"function"==typeof a.callback?a.callback():void 0)}}(this)}),this.container.append(this.button)}return a.prototype.clear=function(a){return this.button.fadeOut(500,function(){return"function"==typeof a?a():void 0})},a}(),f=function(){function a(){this.run=x(this.run,this),this.isMain=null==$blab.resources.getSource,this.start=this.isMain?new i(function(a){return function(){return a.run()}}(this)):new d(function(a){return function(){return a.run()}}(this)),this.start.create(),this.firstLayout=!0,$blab.Layout.on("renderedWidgets",function(a){return function(){var b;if(a.firstLayout)return"function"==typeof(b=a.start).activate&&b.activate(),a.firstLayout=!1}}(this)),this.firstChange=!0,$(document).on("codeNodeChanged",function(a){return function(){return a.firstChange?a.start.clear():void 0}}(this))}return a.prototype.run=function(){return new c},a}(),t=null,u=function(a){return new $blab.utils.CloseButton(a,function(b){return function(){return a.hide(),$.event.trigger("demoGuideClose")}}(this))},q=null,v=null,r=null,s=null,w=null,p=null,g=function(){function a(a,b){this.appEditor=a,this.guide=b,this.editor=this.appEditor.editor,this.ace=this.appEditor.aceEditor,this.firstAppend=!0}return a.prototype.delay=500,a.prototype.charDelay=150,a.prototype.runOnStatement=!1,a.prototype.clearFirst=!1,a.prototype.statement=function(a,b,c){var d;return this.statementStr=a,this.statementCharIdx=0,this.statementLength=this.statementStr.length,this.ace.focus(),d=function(a){return function(){return a.firstAppend||a.ace.insert("\n"),a.firstAppend=!1,a.ace.navigateFileEnd(),a.ace.getCursorPosition().column>0&&a.ace.removeToLineStart(),setTimeout(function(){return a["char"](c)},b)}}(this),this.firstAppend&&this.clearFirst?this.step(function(a){return function(){return a.ace.selection.selectAll()}}(this),function(a){return function(){return a.ace.insert(""),d()}}(this)):d()},a.prototype["char"]=function(a){var b,c;return c=this.statementCharIdx,b=this.statementStr.slice(c,c+1),this.ace.insert(b),c<this.statementLength?(this.statementCharIdx++,setTimeout(function(b){return function(){return b["char"](a)}}(this),this.charDelay)):(this.runOnStatement&&this.editor.run(),a())},a.prototype.replace=function(a,b){var c,d,e,f;return e=a.vline,c=a.line,f=a.word,d=a.replace,null==e&&(e=1),null==c&&(c=this.editor.spec.startLine-1+e),this.ace.focus(),this.gotoLine(c,function(c){return function(){return a.find?c.step(function(){return c.ace.find(a.find)},function(){return a.slow?(c.statementStr=d,c.statementCharIdx=0,c.statementLength=c.statementStr.length,c["char"](b)):c.step(function(){return c.ace.insert(d)},function(){return c.step(function(){return c.runOnStatement?c.editor.run():void 0},function(){return"function"==typeof b?b():void 0})})}):c.navigateRight(f,function(){return c.replaceWordRight(d,function(){return c.step(function(){return c.runOnStatement?c.editor.run():void 0},function(){return"function"==typeof b?b():void 0})})})}}(this))},a.prototype.gotoLine=function(a,b){return this.ace.gotoLine(a),b()},a.prototype.navigateRight=function(a,b){var c,d;return d=0,(c=function(e){return function(){return e.ace.navigateWordRight(),d++,a>d?c():setTimeout(b,e.delay)}}(this))()},a.prototype.replaceWordRight=function(a,b){return this.step(function(a){return function(){return a.ace.selection.selectWordRight()}}(this),function(c){return function(){return c.step(function(){return c.ace.removeWordRight(),c.ace.insert(a),c.ace.navigateWordLeft(),c.ace.selection.selectWordRight()},function(){return b()})}}(this))},a.prototype.step=function(a,b){return a(),setTimeout(function(){return b()},this.delay)},a}(),o=function(){function a(a){this.guide=a}return a.prototype.explain=function(a,b,c){var d,e;return this.guide.show(),d=$(window).height(),e=d/3,this.guide.css({top:e,left:($("body").width()-500)/2,background:null!=b?b:"#ff9",width:500}),this.guide.html(a),u(this.guide),c()},a}(),j=function(a){function b(a){this.guide=a,b.__super__.constructor.call(this,v,this.guide)}return y(b,a),b.prototype.charDelay=50,b.prototype.explain=function(a,b){var c,d;return this.guide.show(),c=this.editor.outer,d=c.offset(),this.guide.animate({top:d.top+10,left:d.left+500},400,b),this.guide.html(a)},b}(g),a=function(a){function b(a){this.guide=a,b.__super__.constructor.call(this,r,this.guide)}return y(b,a),b.prototype.clearFirst=!0,b.prototype.runOnStatement=!0,b.prototype.explain=function(a){var b,c;return this.guide.show(),b=this.editor.container,c=b.position(),this.guide.css({top:c.top+b.height()+40,left:c.left+300}),this.guide.html(a)},b}(g),b=function(a){function b(a){this.guide=a,b.__super__.constructor.call(this,s,this.guide)}return y(b,a),b.prototype.clearFirst=!0,b.prototype.runOnStatement=!0,b.prototype.explain=function(a){var b,c;return this.guide.show(),b=this.editor.container,c=b.position(),this.guide.css({top:c.top+b.height()+30,left:c.left}),this.guide.html(a)},b}(g),h=function(a){function b(a){this.guide=a,b.__super__.constructor.call(this,w,this.guide)}return y(b,a),b.prototype.runOnStatement=!0,b.prototype.explain=function(a,b){var c,d;return this.guide.show(),c=this.editor.outer,d=c.offset(),this.guide.animate({top:d.top+30,left:d.left+500},400,b),this.guide.html(a)},b}(g),m=function(){function a(a){this.guide=a}return a.prototype.delay=200,a.prototype.animate=function(a,b,c){var d,e;return d=0,$.event.trigger("clickInputWidget"),e=function(c){return function(f){var g,h;return h=b[d],g=$blab.Widget.createDomId("slider-",a),$("#"+g).slider("option","value",h),p.widgets[g].setVal(h),p.compute(),d++,d<b.length?setTimeout(function(){return e(f)},c.delay):f()}}(this),setTimeout(function(){return e(c)},1e3)},a.prototype.explain=function(a,b){return this.guide.show(),this.guide.animate({top:20,left:400},400,b),this.guide.html(a)},a}(),n=function(){function a(a){this.guide=a}return a.prototype.delay=1e3,a.prototype.populate=function(a,b,c,d){var e,f;return e=0,(f=function(d){return function(g){var h,i,j,k,l;return l=c[e],j=$blab.Widget.createDomId("table-",a),k=p.widgets[j],h=k.editableCells[b][e],i=e<c.length-1?1:0,h.enterVal(l,i),e++,e<c.length?setTimeout(function(){return f(g)},d.delay):g()}}(this))(d)},a.prototype.explain=function(a,b){var c,d;return this.guide.show(),c=r.editor.container,d=c.position(),this.guide.animate({top:d.top-30,left:d.left},400,b),this.guide.html(a)},a}(),l=function(){function a(){this.steps=[]}return a.prototype.stepDelay=500,a.prototype.step=function(a){return this.steps.push(a)},a.prototype.run=function(){var a,b,c,d;return b=this.steps.length,d=0,a=this.stepDelay,(c=function(e){return function(){var f;return(f=e.steps[d])(function(){return d++,b>d?setTimeout(function(){return c()},a):console.log("Demo done")})}}(this))()},a}(),e=function(){function a(){this.control=$("#demo-control"),this.control.show(),this.pauseImg=$("<img>",{src:"img/UI_78.png","class":"demo-button-img"}),this.playImg=$("<img>",{src:"img/UI_76.png","class":"demo-button-img"}),this.control.click(function(a){return function(){return a.enabled?a.trigger("click"):void 0}}(this)),this.show(!1),this.observers={click:[]}}return a.prototype.text=function(a){return this.control.html(a)},a.prototype.show=function(a,b){return null==a&&(a=!0),null==b&&(b=!1),this.enabled=a,this.control.css({opacity:a?1:.2,cursor:a?"pointer":"default"}),this.control.empty(),this.control.append(b?this.playImg:this.pauseImg)},a.prototype.on=function(a,b){return this.observers[a].push(b)},a.prototype.trigger=function(a,b){var c,d,e,f,g;for(f=this.observers[a],g=[],c=0,d=f.length;d>c;c++)e=f[c],g.push(e(b));return g},a}(),c=function(){function c(){console.log("DEMO"),$.event.trigger("runBlabDemo"),this.isMain=null==$blab.resources.getSource,q.errors.enable=!1,this.script=new l,this.textGuide=new o(t),this.markdown=new j(t),this.computation=new a(t),this.definitions=new b(t),this.layout=new h(t),this.sliders=new m(t),this.tables=new n(t),this.control=new e,this.tId=null,this.nextStep=null,this.control.on("click",function(a){return function(){return a.tId?(a.control.show(!0,!0),clearTimeout(a.tId),a.tId=null):("function"==typeof a.nextStep&&a.nextStep(),a.nextStep=null)}}(this)),$(document).on("demoGuideClose",function(a){return function(){return a.tId?(clearTimeout(a.tId),a.tId=null,a.nextStep(),a.nextStep=null):void 0}}(this)),$blab.demoScript({text:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.text.apply(a,b)}}(this),compute:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.compute.apply(a,b)}}(this),defs:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.defs.apply(a,b)}}(this),widget:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.widget.apply(a,b)}}(this),slider:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.slider.apply(a,b)}}(this),table:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.table.apply(a,b)}}(this),md:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.md.apply(a,b)}}(this),widgetEditor:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.widgetEditor.apply(a,b)}}(this),delays:function(a){return function(){var b;return b=1<=arguments.length?A.call(arguments,0):[],a.delays.apply(a,b)}}(this)}),this.learnMore(),this.script.run()}return c.prototype.dwellDelay=1e3,c.prototype.text=function(a,b,c){return null==b&&(b=this.dwellDelay),null==c&&(c="#ff9"),this.script.step(function(d){return function(e){var f;return f=function(){return t.css({width:"",background:"#ff9"}),t.hide(),e()},d.textGuide.explain(a,c,function(){return d.dwell(b,function(){return f()})})}}(this))},c.prototype.md=function(a,b){return null==b&&(b=this.dwellDelay),a.dwell&&(b=a.dwell),this.script.step(function(c){return function(d){var e,f;return e=v.editor.outer.css("display"),"none"===e&&v.trigger("clickText",{evt:null,start:0}),f=function(){var e;return e=function(){return c.dwell(b,function(){return d()})},a.replace?c.markdown.replace(a,e):a.append?c.markdown.statement(a.append,0,e):a.close?(v.setViewPort(null),e()):void 0},a.guide&&setTimeout(function(){return c.markdown.explain(a.guide)},500),setTimeout(function(){return f()},900)}}(this))},c.prototype.compute=function(a,b,c,d){return null==b&&(b=""),null==c&&(c=this.dwellDelay),null==d&&(d=0),this.script.step(function(e){return function(f){return b.length&&e.computation.explain(b),e.computation.statement(a,d,function(){var a;return a=function(){return t.hide(),f()},e.dwell(c,function(){return a()})})}}(this))},c.prototype.defs=function(a,b,c){return null==b&&(b=""),null==c&&(c=this.dwellDelay),this.script.step(function(d){return function(e){return b.length&&d.definitions.explain(b),d.definitions.statement(a,0,function(){return d.dwell(c,function(){return t.hide(),e()})})}}(this))},c.prototype.widget=function(a){return this.script.step(function(b){return function(c){return b.layout.explain(a.guide,function(){return b.layout.replace(a,function(){var d;return b.dwell(null!=(d=a.dwell)?d:b.dwellDelay,c)})})}}(this))},c.prototype.slider=function(a){var b,c;return b=null!=(c=a.dwell)?c:this.dwellDelay,this.script.step(function(c){return function(d){return c.sliders.explain(a.guide,function(){return c.sliders.animate(a.id,a.vals,function(){return c.dwell(b,function(){return d()})})})}}(this))},c.prototype.table=function(a){var b,c;return b=null!=(c=a.dwell)?c:this.dwellDelay,this.script.step(function(c){return function(d){return c.tables.explain(a.guide,function(){var e;return c.tables.populate(a.id,null!=(e=a.col)?e:0,a.vals,function(){return c.dwell(b,function(){return d()})})})}}(this))},c.prototype.widgetEditor=function(a){return this.script.step(function(b){return function(b){return a.close&&w.setViewPort(null),null!=a.enable&&(q.disablePopupWidgetEditor=!a.enable),b()}}(this))},c.prototype.delays=function(a){return a.step&&(this.script.stepDelay=a.step),a.changeCode&&(this.markdown.delay=a.changeCode,this.computation.delay=a.changeCode,this.layout.delay=a.changeCode),a.mdChar&&(this.markdown.charDelay=a.mdChar),a.codeChar&&(this.computation.charDelay=a.codeChar,this.definitions.charDelay=a.codeChar),a.slider&&(this.sliders.delay=a.slider),a.dwell?this.dwellDelay=a.dwell:void 0},c.prototype.dwell=function(a,b){return this.nextStep=function(a){return function(){return a.control.show(!1),b()}}(this),this.tId=setTimeout(function(a){return function(){return a.nextStep(),a.nextStep=null}}(this),a),this.control.show()},c.prototype.learnMore=function(){return this.script.step(function(a){return function(b){var c,d,e,f;return f='<b>Learn more about Blabr</b><br><br>\nThe "Doc & Examples" link (bottom of page)<br>\nshows demos, examples, and documentation.<br><br>\n<a href="'+window.location+'">Run this demo again</a>',e=1e4,c="#ff9",d=function(){return a.control.control.hide(),t.css({width:"",background:c}),t.hide(),b()},$blab.blabrGuide.slideDown(),a.textGuide.explain(f,c,function(){return a.dwell(e,function(){return d()})})}}(this))},c}(),$blab.initDemoRunner=function(){return t=$("#demo-guide"),t.draggable(),q=$blab.blabrApp,v=q.markdownEditor,r=q.computationEditor,s=q.definitions,w=q.widgetEditor,p=$blab.Widgets,new f}}.call(this),function(){var a,b,c,d;console.log("Blabr Guide"),d={syntaxTips:['k = slider "k"','table "my-table", x, y','x = table "t", [], [-> z]','plot "my-plot", x, y',"x = [1, 2, 3]","x = [1..3]","x = linspace 1, 3, 3","square = (x) -> x*x","# comment"],demos:[{text:"Basic math",id:"58ef3095767efcdf1977"},{text:"Basic plot",id:"3b19d13e5eaa11a4a540"},{text:"Text",id:"277bf74a4b1e7364df29"},{text:"Tables",id:"0a248098997a6f95635c"},{text:"Sliders",id:"9b6fbf80ed838d1e1cef"},{text:"Layout of components",id:"c7837da7dd136710e2ba"},{text:"Function definitions",id:"e8457f2a62b292e1d0a2"},{text:"Importing definitions",id:"d1889126b58315ba2239"},{text:"Programming",id:"01df7d9c87dab79fccf0"},{text:"Example: lunar crust I",id:"2c7e4d04634ee1d2aa40"},{text:"Example: lunar crust II",id:"e9f3424ada245162d24f"}],examples:[{text:"Mystery Curve",img:"//blabr.org/img/mystery-curve.png",id:"4bd90a0b619bff7707b3"},{text:"Basic Properties of Mars as a Planetary Body",img:"//spacemath.github.io/resources/images/thumbs/mars2.png",id:"3df6e2368e89a8c3f780"
},{text:"Exploring the Interior of Pluto",img:"//spacemath.github.io/resources/images/thumbs/planet-core.png",id:"d6927773b95652943582"},{text:"Star Trek's solitons are real",img:"//blabr.org/img/solitons.png",id:"2a55efd937f9d3e87d29"},{text:"A toy problem for compressive sensing",img:"//blabr.org/img/cs-intro.png",id:"e8a066234715f21c21fd"}],references:[{text:"Widgets",id:"ff66265ccd580d6a9b04"},{text:"Language overview",id:"cac35c998a6640457c39"},{text:"Definitions and imports",id:"919000f98b993fcfeb81"},{text:"Math functions",id:"c19c10d7828efd13ddee"},{text:"Vectors and matrices",id:"cb9ef53d61658dcedd45"},{text:"Complex numbers",id:"c182256cc10492eb43b5"},{text:"Linear algebra and numeric",id:"19516c877c92649672f4"},{text:"Utilities",id:"ccd42df2e696df7e9317"}],credits:[{name:"Ace",url:"ace.c9.io"},{name:"CoffeeScript",url:"coffeescript.org"},{name:"MathJax",url:"mathjax.org"},{name:"numericjs",url:"numericjs.com"},{name:"Flot",url:"flotcharts.org"},{name:"PaperScript",url:"paperjs.org/reference/paperscript"},{name:"jQuery",url:"jquery.com"},{name:"GitHub",url:"github.com"},{name:"SpaceMath",url:"spacemath.gsfc.nasa.gov"}]},b=function(){function b(){var b;this.container=$("#demo-list"),this.container.hide(),this.isMain=null==$blab.resources.getSource,this.container.empty(),new $blab.utils.CloseButton(this.container,function(a){return function(){return a.container.slideUp(500,function(){var b;return null!=(b=a.guideControl)?b.show():void 0})}}(this)),this.tips(),this.demos(),this.examples(),b=this.references(),new a(this.container,b,d.credits)}return b.prototype.append=function(a){return this.container.append(a)},b.prototype.slideDown=function(){return this.container.slideDown(500,function(a){return function(){return a.scroll()}}(this))},b.prototype.slideToggle=function(){return this.container.slideToggle(500,function(a){return function(){return a.scroll()}}(this))},b.prototype.scroll=function(){var a,b,c,d,e;if(this.container.is(":visible"))return d=$(window).scrollTop(),a=this.container.offset().top,e=$(window).height(),b=this.container.height(),c=a+b-(d+e),c>0?$("html, body").animate({scrollTop:d+c+70},400):void 0},b.prototype.tips=function(){var a,b,c,e,f;for(e="",c=d.syntaxTips,a=0,b=c.length;b>a;a++)f=c[a],e+="<code>"+f+"</code><br>";return this.append('<div class="guide-col">\n  <h3>Quick Syntax Tips</h3>\n  '+e+"\n</div>")},b.prototype.demos=function(){return this.append('<div class="guide-col">\n  <h3>Demos</h3>\n  '+$blab.demoListHtml({blank:!0})+"\n</div>")},b.prototype.examples=function(){var a,b,c,e,f;for(f="",e=d.examples,b=0,c=e.length;c>b;b++)a=e[b],f+='<div class="gist">\n<a href=\'//blabr.io?'+a.id+"' target=\"_blank\">\n<img src='"+a.img+"'>\n<p>"+a.text+"</p>\n</a>\n</div>";return this.append('<div class="guide-col">\n  <h3>Examples</h3>\n  '+f+"\n</div>")},b.prototype.references=function(){var a;return a=$("<div>",{"class":"guide-col"}),this.append(a),a.append("<h3>Reference</h3>\n"+$blab.refListHtml({blank:!0})+'\n<br>\n<a href="//coffeescript.org" target="_blank">CoffeeScript language guide</a>\n<br><br>'),a},b}(),c=function(){function a(a){this.guide=a,this.tagline=$("#blabr-tagline"),this.tagline.show(),this.button=$("#demo-list-button"),this.button.click(function(a){return function(){return"function"==typeof a.click?a.click():void 0}}(this)),this.show()}return a.prototype.show=function(a){return null==a&&(a=!0),this.click=function(){},this.tagline.animate({opacity:a?1:0}),this.tagline.css({cursor:a?"text":"default"}),this.button.css({cursor:a?"pointer":"default"}),a?this.click=function(a){return function(){return a.show(!1),a.guide.slideDown(500)}}(this):void 0},a}(),a=function(){function a(a,b,c){var d,e,f;this.container=a,this.containerButton=b,this.credits=c,this.button=$("<button>",{text:"About Blabr",click:function(a){return function(){return a.footer.slideToggle(500)}}(this)}),this.containerButton.append(this.button),this.footer=$("<div>",{"class":"guide-footer"}),this.container.append(this.footer),this.footer.hide(),e=function(a,b){return"<a href='//"+b+"' target='_blank'>"+a+"</a>"},f=function(){var a,b,c,f;for(c=this.credits,f=[],a=0,b=c.length;b>a;a++)d=c[a],f.push(e(d.name,d.url));return f}.call(this).join(", "),this.footer.append("<a href='//blabr.org' target='_blank'>Blabr</a> \nis developed by Martin Clark and Gary Ballantyne (Haulashore Limited) \nas part of the <a href='//github.com/puzlet' target='_blank'>Puzlet</a> project.<br>\nThanks to: "+f+".")}return a}(),$blab.demoListHtml=function(a){var b,c,e,f,g,h,i,j;for(e="<ul>\n",i=d.demos,f=0,h=i.length;h>f;f++)g=i[f],b=g.id===a.highlight?"demo-list-item-highlight":"",j=a.blank?" target = '_blank'":"",c=g.id?"?"+g.id:"",e+="<li><a class='"+b+"' href='"+c+"'"+j+">"+g.text+"</a></li>\n";return e+="</ul>\n"},$blab.refListHtml=function(a){var b,c,e,f,g,h;for(b="<ul>\n",g=d.references,c=0,f=g.length;f>c;c++)e=g[c],h=a.blank?" target = '_blank'":"",b+="<li><a href='?"+e.id+"'"+h+">"+e.text+"</a></li>\n";return b+="</ul>\n"},$blab.guideClass=b}.call(this),function(){var a;a=function(){function a(a,b){this.container=a,this.callback=b,this.button=$("<div>",{"class":"close-button"}),this.img=$("<img>",{src:"img/UI_175.png",click:function(a){return function(){return"function"==typeof a.callback?a.callback():void 0}}(this)}),this.button.append(this.img),this.container.append(this.button)}return a.prototype.css=function(a){return this.button.css(a)},a}(),$blab.utils={CloseButton:a}}.call(this);